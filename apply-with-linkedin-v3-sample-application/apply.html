<html style="background-color: #f4f2f2;">

<head>
  <!-- CSS only -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
    integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
    crossorigin="anonymous"></script>
  <script src="./awli-widget-helper.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
</head>

<body id="body" class="container p-3">

  <div class="d-flex justify-content-end">

  </div>
  <div id="profile-data-container" class="container well">
    <div>
      <h2 class="page-title"> <span class="amber-text"></span><span class="light-blue-text">Apply With LinkedIn 3.0 -
          Developer Demo</span></h2>
    </div>
  </div>

  <div id="profile-data-container" class="container well">
    <div class="section"></div>
    <h4 class="blue-grey-text text-darken-3">Director of Product Management [Sample] </h4>
    <h6>SAN FRANCISCO || PRODUCT || FULL-TIME</h6>
    <div class="section"></div>
    <div>
      <p class="blue-grey-text text-darken-3">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
        laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui
        officia deserunt mollit anim id est laborum.</p>
    </div>


    <form class="collapse p-3" id="widgetSettings">
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="data-api-key">API Key</label>
          <input class="form-control" type="text" id="data-api-key" value="77q8xmpyw5z8fj">
        </div>
        <div class="form-group col-md-6">
          <label for="data-integration-context">Integration Context</label>
          <input class="form-control" type="text" id="data-integration-context" value="urn:li:organization:1337">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-3">
          <label for="env">Environment</label>
          <select class="form-control" id="env">
            <option value="EI">EI</option>
            <option value="PROD" selected>PROD</option>
          </select>
        </div>
        <div class="form-group col-md-3">
          <label for="data-size">Size</label>
          <select class="form-control" id="data-size">
            <option value="small">Small</option>
            <option value="medium" selected>Medium</option>
            <option value="large">Large</option>
          </select>
        </div>
        <div class="form-group col-md-3">
          <label for="data-color">Color</label>
          <select class="form-control" id="data-color">
            <option value="blue" selected>Blue</option>
            <option value="black">Black</option>
            <option value="white">White</option>
          </select>
        </div>
        <div class="form-group col-md-3">
          <label for="data-mode">Mode</label>
          <select class="form-control" id="data-mode">
            <option value="BUTTON_DATA" selected>BUTTON_DATA</option>
            <option value="CONVERSION">CONVERSION</option>
          </select>
        </div>
      </div>
      <button type="submit" id="renderBtn" class="btn btn-primary">Update</button>
    </form>
  </div>

  <div id="widget-container">
    <script src="https://platform.linkedin.com/xdoor/scripts/in.js">
      api_key: {customer app API Key goes here}
      extensions: AwliWidget @https://www.linkedin.com/talentwidgets/extensions/apply-with-linkedin-widget-v3
    </script>
    <div class="container">
      <script type="IN/AwliWidget" data-company-job-code=‚Äù{UniqueJobCode}‚Äù
        data-integration-context="urn:li:organization:{id}" data-mode="BUTTON_DATA"
        data-callback-method="handleProfileData" data-height="50"></script>
    </div>
  </div>
  <form id="profile-data-container" class="container well">
    <h4>Profile data will show here</h4>
    <div id="profile_data_form"></div>
    <div id="signature-verification"></div>
    <div class="form-group">
      <label for="firstname">First Name</label>
      <input class="form-control" type="text" id="firstname">
    </div>
    <div class="form-group">
      <label for="lastname">Last Name</label>
      <input class="form-control" type="text" id="lastname">
    </div>
    <div class="form-group">
      <label for="headline">Title</label>
      <input class="form-control" type="text" id="headline">
    </div>
    <div class="form-group">
      <label for="email">Email Address</label>
      <input class="form-control" type="text" id="email">
    </div>
    <div class="form-group">
      <label for="skills">Skills</label>
      <textarea placeholder="" id="skills" type="text" class="materialize-textarea"></textarea>
    </div>

    <div class="form-group">
      <label for="educations">Educations</label>
      <textarea placeholder="" id="educations" type="text" class="materialize-textarea"></textarea>

    </div>

    <div class="input-field col s12">
      <a id="submit-application" class="waves-effect waves-green btn">Submit</a>
    </div>
    </div>
  </form>

  <script async defer>
    var editor;

    const hexify = (buffer, minLength) => buffer.map(byte => byte.toString(16).padStart(2, '0')).join('').padStart(minLength, '0')

    // ‚ö†Ô∏è This function should not be implemented on the client side in production code.
    // It is only implemented here to demonstrate how to verify the signature.
    async function verifySignature (data, signature, password) {
      if (!window.crypto || !window.crypto.subtle) {
        throw new Error('Browser does not support Web Cryptography API. Ensure your URL is http://localhost (not http://127.0.0.1) or üîíhttps:// (not üîìhttp://).')
      }
      // Encode the password and data as ArrayBuffers
      const encoder = new TextEncoder()
      const passwordData = encoder.encode(password)
      const inputData = encoder.encode(data)

      // Import the password as a CryptoKey
      const passwordKey = await crypto.subtle.importKey(
        'raw',
        passwordData,
        { name: 'HMAC', hash: 'SHA-256' },
        true,
        ['sign']
      )
      const keyData = new Uint8Array(await crypto.subtle.exportKey('raw', passwordKey))

      // Generate the HMAC-SHA256 hash
      const hashBuffer = await crypto.subtle.sign('HMAC', passwordKey, inputData)

      // Convert the hash ArrayBuffer to a hex string
      const hashArray = Array.from(new Uint8Array(hashBuffer))
      const hmac = hexify(hashArray, 64)

      console.group('%cSignature Verification:', 'font-weight: bold; font-size: 16px;')
      console.info('Password     :', password)
      console.info('Password Data:', hexify(keyData, 0))
      console.info('Data         :', [data])
      console.info('Input Data   :', [hexify(inputData, 64)])
      console.info('Computed HMAC:', hmac)
      console.info('Expected HMAC:', signature)
      console.groupEnd()
      return hmac === signature
    }

    function handleProfileData(profileResponse, signature) {
      console.log('profileResponse', profileResponse);
      console.log('signature', signature);

      var signatureField = document.getElementById('signature');
      signatureField.value = signature;

      const profileData = profileResponse;
      editor.setValue(profileData);
      firstnameField = document.getElementById('firstname');
      var lastnameField = document.getElementById('lastame');
      var headlineField = document.getElementById('headline');
      var educationField = document.getElementById('education');
      var experienceField = document.getElementById('experience')
      var skillsField = document.getElementById('skills')
      firstnameField.value = profileData.localizedFirstName;
      lastnameField.value = profileData.localizedLastName;
      educationField.value = JSON.stringify(profileData.educations);
      headlineField.value = profileData.localizedHeadline;
      experienceField.value = JSON.stringify(profileData.positions);
      skillsField.value = JSON.stringify(profileData.skills);
    }
    function handleProfileData(payload, signature) {
        verifySignature(
          'hmacsha256=' + JSON.stringify(payload),
          signature,
          '<YOUR_SECRET_KEY>'
        )
          .then(matches => {
            $('#signature-verification').html(
              matches
                ? '‚úÖ Signature verified.'
                : '‚ùå Signature verification failed. Check console for details.'
            )
          })
          .catch(err => {
            $('#signature-verification').html('‚ö†Ô∏è ' + err.message)
          })
      $('#full-text').val(JSON.stringify(payload));
      $('#firstname').val(payload.firstName);
      $('#lastname').val(payload.lastName);
      $('#headline').val(payload.headline);
      $.each(payload.positions, function (key, value) {
        $('#positions').val($('#positions').val() + "\n" + value.title);
        console.log(value.title);
      })
      $.each(payload.educations, function (key, value) {
        $('#educations').val($('#educations').val() + "\n" + value.schoolName);
        console.log(value.schoolName);
      })
      $.each(payload.skills, function (key, value) {
        $('#skills').val($('#skills').val() + "\n" + value.name);
        console.log(value.name);
      })
      $('#email').val(payload.emailAddress);

      M.toast({ html: "Form pre-filled" })

    };


    // Redirects to the confirm page when application is submitted.
    $("#submit-application").click(function () {
      key = $("#key").val();
      integrationContext = $("#integContext").val();
      window.location.replace("/apply-confirm.html?key=" + key + "&ic=" + integrationContext);
    });

  </script>
</body>

</html>
<html>

<head>
  <!-- Jquery   -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <!--Materialize-->
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.3/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <title> AWLI - Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="text/javascript">
    function onProfileData(payload) {

      $('#full-text').val(JSON.stringify(payload));
      $('#first_name').val(payload.firstName);
      $('#last_name').val(payload.lastName);
      $('#title').val(payload.headline);
      $.each(payload.skills, function (key, value) {
        $('#skills').val($('#skills').val() + "\n" + value.name);
        console.log(value.name);
      })
      $('#email').val(payload.emailAddress);
      $('#phone').val(payload.phoneNumber);

      M.toast({ html: "Form pre-filled" })

    };

    $(document).ready(function () {

      // Loads the widget when the load button is clicked
      $("#load").click(function () {
        key = $("#key").val();
        $('#awli-widget').attr('data-api-key', key);
        integrationContext = $("#integContext").val();
        $('#awli-widget').attr('data-integration-context', integrationContext);
        console.log(key);
        console.log($('#awli-widget').attr('data-api-key'));

        // This event is triggered to reload the widget. 
        // This may be used in your app to reload the widget if needed
        var event = new Event('awli-widget-load');
        window.dispatchEvent(event);
      });

      // Redirects to the confirm page when application is submitted.
      $("#submit-application").click(function () {
        key = $("#key").val();
        integrationContext = $("#integContext").val();
        window.location.replace("/apply-confirm.html?key=" + key + "&ic=" + integrationContext);
      });

    });
  </script>
</head>

<body>
  <footer class="page-footer light-blue">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">LinkedIn</h5>
          <p class="grey-text text-lighten-4">This is a demo of Apply With LinkedIn.</p>
        </div>
        <div class="col l4 offset-l2 s12">
          <h5 class="white-text">Links</h5>
          <ul>
            <li><a class="grey-text text-lighten-3" href="">AWLI 3.0</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">¬© 2022 Copyright Text </div>
    </div>
  </footer>
  </div>
  <!-- Compiled and minified JavaScript for Materialize -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
</body>

</html>
